{"version":3,"file":"index.js","mappings":"ygEAAA,aACA,QACA,SAEA,YACA,SAEMA,EAAQ,EAAAC,MAAM,WAEd,EAAuB,UAAW,CAAEC,eAAe,EAAMC,QAAQ,EAAMC,iBAAiB,IAAtFC,EAAK,QAAEC,EAAS,YAExB,cACE,WAAYC,EAAaC,EAAmBC,GAA5C,IACQC,EAA6B,CACjCC,QAASJ,EACTK,aAAc,OACdC,uBAAmBC,EACnBC,eAAgB,WAAM,W,OAGpBP,GAAYC,KACdC,EAAOM,KAAO,CAAER,SAAQ,EAAEC,SAAQ,IAGpC,YAAMC,IAAO,KAwCjB,OArD6C,OAgB3C,YAAAO,gBAAA,SAAgBC,EAAgBC,GAC9B,IAEMC,EAAM,CAAEC,GAFHC,KAAKC,MAEEL,OAAM,EAAEM,QADV,MACmBL,OAAM,GAIzC,OAFAnB,EAAM,kBAAmBoB,GAElBA,GAGT,YAAAK,eAAA,SAAeC,GACb1B,EAAM,uBAAwB0B,GAE9B,IAAMC,EAAsC,iBAAVD,EAAqBpB,EAAUoB,GAASA,EAEpEE,EAAOvB,EAAMsB,GAEnB3B,EAAM,0BAA2B4B,GAEzB,IAAAC,EAAUD,EAAI,MAEtB,GAAa,MAATC,EACF,MAAM,IAAI,EAAAC,UAAUD,EAAME,SAAWF,GAGvC,IAAK,EAAAG,IAAIJ,EAAM,UACb,MAAM,IAAI,EAAAE,UAAU,2CAGtB,OAAOF,EAAKK,QAGR,YAAAT,QAAN,SAAcN,G,IAAgB,wD,gGACf,SAAM,YAAMgB,SAAQ,UAAC,GAAIC,KAAKlB,gBAAgBC,EAAQC,K,OAEnE,OAFMS,EAAO,SAEN,CAAP,EAAOO,KAAKV,eAAeG,YAE/B,EArDA,CAA6C,EAAAQ,c,+LCX7C,gBAES,EAAAC,gBAFF,W,OCAPC,EAAOC,QAAUC,QAAQ,qB,QCAzBF,EAAOC,QAAUC,QAAQ,sB,QCAzBF,EAAOC,QAAUC,QAAQ,6B,QCAzBF,EAAOC,QAAUC,QAAQ,gB,QCAzBF,EAAOC,QAAUC,QAAQ,YCCrBC,EAA2B,GCE3BC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqB9B,IAAjB+B,EACH,OAAOA,EAAaN,QAGrB,IAAID,EAASG,EAAyBG,GAAY,CAGjDL,QAAS,IAOV,OAHAO,EAAoBF,GAAUG,KAAKT,EAAOC,QAASD,EAAQA,EAAOC,QAASI,GAGpEL,EAAOC,QClBWI,CAAoB,K","sources":["webpack://@liquality/jsonrpc-provider/./lib/JsonRpcProvider.ts","webpack://@liquality/jsonrpc-provider/./lib/index.ts","webpack://@liquality/jsonrpc-provider/external commonjs \"@liquality/debug\"","webpack://@liquality/jsonrpc-provider/external commonjs \"@liquality/errors\"","webpack://@liquality/jsonrpc-provider/external commonjs \"@liquality/node-provider\"","webpack://@liquality/jsonrpc-provider/external commonjs \"json-bigint\"","webpack://@liquality/jsonrpc-provider/external commonjs \"lodash\"","webpack://@liquality/jsonrpc-provider/webpack/bootstrap","webpack://@liquality/jsonrpc-provider/webpack/startup"],"sourcesContent":["import { NodeProvider, AxiosRequestConfig, AxiosResponse } from '@liquality/node-provider'\nimport { Debug } from '@liquality/debug'\nimport { NodeError } from '@liquality/errors'\n\nimport JSONBigInt from 'json-bigint'\nimport { has } from 'lodash'\n\nconst debug = Debug('jsonrpc')\n\nconst { parse, stringify } = JSONBigInt({ storeAsString: true, strict: true, useNativeBigInt: true })\n\nexport default class JsonRpcProvider extends NodeProvider {\n  constructor(uri: string, username?: string, password?: string) {\n    const config: AxiosRequestConfig = {\n      baseURL: uri,\n      responseType: 'text',\n      transformResponse: undefined, // https://github.com/axios/axios/issues/907,\n      validateStatus: () => true\n    }\n\n    if (username || password) {\n      config.auth = { username, password }\n    }\n\n    super(config)\n  }\n\n  _prepareRequest(method: string, params: any[]) {\n    const id = Date.now()\n    const jsonrpc = '2.0'\n    const req = { id, method, jsonrpc, params }\n\n    debug('jsonrpc request', req)\n\n    return req\n  }\n\n  _parseResponse(_data: AxiosResponse): any {\n    debug('raw jsonrpc response', _data)\n\n    const dataString: string = typeof _data !== 'string' ? stringify(_data) : _data\n\n    const data = parse(dataString)\n\n    debug('parsed jsonrpc response', data)\n\n    const { error } = data\n\n    if (error != null) {\n      throw new NodeError(error.message || error)\n    }\n\n    if (!has(data, 'result')) {\n      throw new NodeError('Missing `result` on the RPC call result')\n    }\n\n    return data.result\n  }\n\n  async jsonrpc(method: string, ...params: any[]) {\n    const data = await super.nodePost('', this._prepareRequest(method, params))\n\n    return this._parseResponse(data)\n  }\n}\n","import JsonRpcProvider from './JsonRpcProvider'\n\nexport { JsonRpcProvider }\n","module.exports = require(\"@liquality/debug\");","module.exports = require(\"@liquality/errors\");","module.exports = require(\"@liquality/node-provider\");","module.exports = require(\"json-bigint\");","module.exports = require(\"lodash\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(175);\n"],"names":["debug","Debug","storeAsString","strict","useNativeBigInt","parse","stringify","uri","username","password","config","baseURL","responseType","transformResponse","undefined","validateStatus","auth","_prepareRequest","method","params","req","id","Date","now","jsonrpc","_parseResponse","_data","dataString","data","error","NodeError","message","has","result","nodePost","this","NodeProvider","JsonRpcProvider","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"sourceRoot":""}