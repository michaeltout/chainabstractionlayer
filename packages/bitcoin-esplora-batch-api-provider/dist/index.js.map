{"version":3,"file":"index.js","mappings":"6pEAAA,aACA,SACA,SACA,SACA,SAQA,cAGE,WAAYA,GAAZ,MACE,YAAMA,IAAQ,K,OAEd,EAAKC,YAAc,IAAI,EAAAC,aAAa,CAClCC,QAASH,EAAQI,SACjBC,aAAc,OACdC,uBAAmBC,I,EAkCzB,OA3C4D,OAapD,YAAAC,uBAAN,SAA6BC,G,oGAEF,OADnBC,EAAYD,EAAWE,IAAI,EAAAC,iBACR,GAAMC,KAAKZ,YAAYa,SAAS,kBAAmB,CAC1EJ,UAAW,EAAAK,KAAKL,M,OAalB,OAdMM,EAAmB,SAInBC,EAAQD,EAAKL,KAAI,SAAC,G,IAAEO,EAAO,UAC/B,OADqC,OACzBP,KAAI,SAACQ,GAAQ,cACpBA,GAAG,CACND,QAAO,EACPE,SAAUD,EAAIE,MACdC,OAAQ,IAAI,EAAAC,UAAUJ,EAAIE,OAAOG,UAAU,KAAKC,WAChDC,YAAaP,EAAIQ,OAAOC,qBAIrB,CAAP,EAAO,EAAAC,QAAQZ,YAGX,YAAAa,4BAAN,SAAkCrB,G,gGAEA,OAD1BC,EAAYD,EAAWE,IAAI,EAAAC,iBACD,GAAMC,KAAKZ,YAAYa,SAAS,aAAc,CAC5EJ,UAAW,EAAAK,KAAKL,M,OAGlB,MAAO,CAAP,EAJgC,SAIpBqB,QAAO,SAACC,EAAkCb,GAEpD,OADAa,EAAIb,EAAID,SAAWC,EAAIc,YAAYC,SAAWf,EAAIgB,cAAcD,SACzDF,IACN,aAEP,EA3CA,CAA4D,EAAAI,2B,8MCZ5D,eAES,EAAAC,+BAFF,W,QCAPC,EAAOC,QAAUC,QAAQ,4C,QCAzBF,EAAOC,QAAUC,QAAQ,6B,QCAzBF,EAAOC,QAAUC,QAAQ,qB,QCAzBF,EAAOC,QAAUC,QAAQ,qB,QCAzBF,EAAOC,QAAUC,QAAQ,YCCrBC,EAA2B,GCE3BC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqBrC,IAAjBsC,EACH,OAAOA,EAAaN,QAGrB,IAAID,EAASG,EAAyBG,GAAY,CAGjDL,QAAS,IAOV,OAHAO,EAAoBF,GAAUG,KAAKT,EAAOC,QAASD,EAAQA,EAAOC,QAASI,GAGpEL,EAAOC,QClBWI,CAAoB,K","sources":["webpack://@liquality/bitcoin-esplora-batch-api-provider/./lib/BitcoinEsploraBatchApiProvider.ts","webpack://@liquality/bitcoin-esplora-batch-api-provider/./lib/index.ts","webpack://@liquality/bitcoin-esplora-batch-api-provider/external commonjs \"@liquality/bitcoin-esplora-api-provider\"","webpack://@liquality/bitcoin-esplora-batch-api-provider/external commonjs \"@liquality/node-provider\"","webpack://@liquality/bitcoin-esplora-batch-api-provider/external commonjs \"@liquality/types\"","webpack://@liquality/bitcoin-esplora-batch-api-provider/external commonjs \"@liquality/utils\"","webpack://@liquality/bitcoin-esplora-batch-api-provider/external commonjs \"lodash\"","webpack://@liquality/bitcoin-esplora-batch-api-provider/webpack/bootstrap","webpack://@liquality/bitcoin-esplora-batch-api-provider/webpack/startup"],"sourcesContent":["import { NodeProvider } from '@liquality/node-provider'\nimport { BigNumber, Address } from '@liquality/types'\nimport { addressToString } from '@liquality/utils'\nimport { BitcoinEsploraApiProvider, EsploraApiProviderOptions, esplora } from '@liquality/bitcoin-esplora-api-provider'\nimport { flatten, uniq } from 'lodash'\n\ntype BatchUTXOs = { address: string; utxo: esplora.UTXO[] }[]\n\ninterface EsploraBatchApiProviderOptions extends EsploraApiProviderOptions {\n  batchUrl: string\n}\n\nexport default class BitcoinEsploraBatchApiProvider extends BitcoinEsploraApiProvider {\n  _batchAxios: NodeProvider\n\n  constructor(options: EsploraBatchApiProviderOptions) {\n    super(options)\n\n    this._batchAxios = new NodeProvider({\n      baseURL: options.batchUrl,\n      responseType: 'text',\n      transformResponse: undefined // https://github.com/axios/axios/issues/907,\n    })\n  }\n\n  async getUnspentTransactions(_addresses: (Address | string)[]) {\n    const addresses = _addresses.map(addressToString)\n    const data: BatchUTXOs = await this._batchAxios.nodePost('/addresses/utxo', {\n      addresses: uniq(addresses)\n    })\n\n    const utxos = data.map(({ address, utxo }) => {\n      return utxo.map((obj) => ({\n        ...obj,\n        address,\n        satoshis: obj.value,\n        amount: new BigNumber(obj.value).dividedBy(1e8).toNumber(),\n        blockHeight: obj.status.block_height\n      }))\n    })\n\n    return flatten(utxos)\n  }\n\n  async getAddressTransactionCounts(_addresses: (Address | string)[]) {\n    const addresses = _addresses.map(addressToString)\n    const data: esplora.Address[] = await this._batchAxios.nodePost('/addresses', {\n      addresses: uniq(addresses)\n    })\n\n    return data.reduce((acc: { [index: string]: number }, obj) => {\n      acc[obj.address] = obj.chain_stats.tx_count + obj.mempool_stats.tx_count\n      return acc\n    }, {})\n  }\n}\n","import BitcoinEsploraBatchApiProvider from './BitcoinEsploraBatchApiProvider'\n\nexport { BitcoinEsploraBatchApiProvider }\n","module.exports = require(\"@liquality/bitcoin-esplora-api-provider\");","module.exports = require(\"@liquality/node-provider\");","module.exports = require(\"@liquality/types\");","module.exports = require(\"@liquality/utils\");","module.exports = require(\"lodash\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(175);\n"],"names":["options","_batchAxios","NodeProvider","baseURL","batchUrl","responseType","transformResponse","undefined","getUnspentTransactions","_addresses","addresses","map","addressToString","this","nodePost","uniq","data","utxos","address","obj","satoshis","value","amount","BigNumber","dividedBy","toNumber","blockHeight","status","block_height","flatten","getAddressTransactionCounts","reduce","acc","chain_stats","tx_count","mempool_stats","BitcoinEsploraApiProvider","BitcoinEsploraBatchApiProvider","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"sourceRoot":""}