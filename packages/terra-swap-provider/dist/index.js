(()=>{"use strict";var t={687:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,a){function i(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(i,s)}c((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(882),c=r(960),u=r(798),l=r(157),d=r(108),h=function(t){function e(e,r){var n=t.call(this)||this;return n._network=e,n._asset=r,n}return o(e,t),e.prototype.getSwapSecret=function(t){return a(this,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return[4,this.getMethod("getTransactionByHash")(t)];case 1:if(!(e=r.sent()))throw new c.TxNotFoundError("Transaction with hash: "+t+" was not found");return[2,null==e?void 0:e.secret]}}))}))},e.prototype.initiateSwap=function(t,e){return a(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return u.validateSwapParams(t),r=this._instantiateContractMessage(t),[4,this.getMethod("sendTransaction")({data:{msgs:[r],fee:e}})];case 1:return[2,n.sent()]}}))}))},e.prototype.claimSwap=function(t,e,r){return a(this,void 0,void 0,(function(){var n,o;return i(this,(function(a){switch(a.label){case 0:return l.validateSecretAndHash(r,t.secretHash),[4,this.verifyInitiateSwapTransaction(t,e)];case 1:return a.sent(),[4,this.getMethod("getTransactionByHash")(e)];case 2:return n=a.sent(),o=this._executeContractMessage(n._raw.contractAddress,{claim:{secret:r}}),[4,this.getMethod("sendTransaction")({data:{msgs:[o]}})];case 3:return[2,a.sent()]}}))}))},e.prototype.refundSwap=function(t,e){return a(this,void 0,void 0,(function(){var r,n;return i(this,(function(o){switch(o.label){case 0:return[4,this.verifyInitiateSwapTransaction(t,e)];case 1:return o.sent(),[4,this.getMethod("getTransactionByHash")(e)];case 2:return r=o.sent(),n=this._executeContractMessage(r._raw.contractAddress,{refund:{}}),[4,this.getMethod("sendTransaction")({data:{msgs:[n]}})];case 3:return[2,o.sent()]}}))}))},e.prototype.fundSwap=function(){return a(this,void 0,void 0,(function(){return i(this,(function(t){return[2,null]}))}))},e.prototype.verifyInitiateSwapTransaction=function(t,e){return a(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return u.validateSwapParams(t),[4,this.getMethod("getTransactionByHash")(e)];case 1:if(!(r=n.sent()))throw new c.TxNotFoundError("Transaction not found: "+e);if(d.isTxError(r))throw new c.StandardError("Encountered an error while running the transaction: "+r.code+" "+r.codespace);if(r._raw.codeId!==this._network.codeId)throw new c.StandardError("Transaction is from different template: "+r.codeId);if(!u.doesTransactionMatchInitiation(t,r._raw))throw new c.StandardError("Transactions are not matching");return[2,!0]}}))}))},e.prototype._instantiateContractMessage=function(t){var e,r=this.getMethod("_getAccAddressKey")(),n=this._network.codeId;return new d.MsgInstantiateContract(r,null,n,{buyer:t.recipientAddress,seller:t.refundAddress,expiration:t.expiration,value:t.value.toNumber(),secret_hash:t.secretHash},((e={})[this._asset]=t.value.toNumber(),e))},e.prototype._executeContractMessage=function(t,e){var r=this.getMethod("_getAccAddressKey")();return new d.MsgExecuteContract(r,t,e)},e}(s.Provider);e.default=h},175:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TerraSwapProvider=void 0;var o=n(r(687));e.TerraSwapProvider=o.default},960:t=>{t.exports=require("@liquality/errors")},882:t=>{t.exports=require("@liquality/provider")},798:t=>{t.exports=require("@liquality/terra-utils")},157:t=>{t.exports=require("@liquality/utils")},108:t=>{t.exports=require("@terra-money/terra.js")}},e={},r=function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}(175);module.exports=r})();
//# sourceMappingURL=index.js.map