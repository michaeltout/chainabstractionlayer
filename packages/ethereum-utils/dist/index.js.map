{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@liquality/ethereum-utils/./lib/index.ts","webpack://@liquality/ethereum-utils/external commonjs \"@liquality/crypto\"","webpack://@liquality/ethereum-utils/external commonjs \"@liquality/errors\"","webpack://@liquality/ethereum-utils/external commonjs \"@liquality/types\"","webpack://@liquality/ethereum-utils/external commonjs \"@liquality/utils\"","webpack://@liquality/ethereum-utils/external commonjs \"eip55\"","webpack://@liquality/ethereum-utils/webpack/bootstrap","webpack://@liquality/ethereum-utils/webpack/startup"],"sourcesContent":["import { ethereum, Transaction, BigNumber, Address } from '@liquality/types'\nimport { padHexStart } from '@liquality/crypto'\nimport { addressToString, validateExpiration as _validateExpiration } from '@liquality/utils'\nimport { InvalidAddressError, InvalidExpirationError } from '@liquality/errors'\n\nimport eip55 from 'eip55'\n\nconst GWEI = 1e9\n\n/**\n * Converts a hex string to the ethereum format\n * @param {*} hash\n */\nfunction ensure0x(hash: string) {\n  return hash.startsWith('0x') ? hash : `0x${hash}`\n}\n\n/**\n * Converts an ethereum hex string to the standard format\n * @param {*} hash\n */\nfunction remove0x(hash: ethereum.Hex) {\n  return typeof hash === 'string' && hash.startsWith('0x') ? hash.slice(2) : hash\n}\n\n/**\n * Converts an ethereum hex string to number\n * @param hex\n */\nfunction hexToNumber(hex: ethereum.Hex): number {\n  return parseInt(remove0x(hex), 16)\n}\n\nfunction numberToHex(number: BigNumber | number): string {\n  return ensure0x(new BigNumber(number).toString(16))\n}\n\nfunction checksumEncode(hash: string) {\n  return eip55.encode(ensure0x(hash))\n}\n\nfunction ensureBlockFormat(block?: number) {\n  if (block === undefined) {\n    return 'latest'\n  } else {\n    return ensure0x(padHexStart(block.toString(16)))\n  }\n}\n\nfunction normalizeTransactionObject<TxType extends ethereum.PartialTransaction = ethereum.Transaction>(\n  tx: TxType,\n  currentHeight?: number\n): Transaction<TxType> {\n  if (!(typeof tx === 'object' && tx !== null)) {\n    throw new Error(`Invalid transaction object: \"${tx}\"`)\n  }\n\n  const normalizedTx: Transaction<TxType> = {\n    hash: remove0x(tx.hash),\n    value: hexToNumber(tx.value),\n    _raw: tx\n  }\n\n  if (tx.blockNumber) {\n    normalizedTx.blockNumber = hexToNumber(tx.blockNumber)\n    normalizedTx.blockHash = remove0x(tx.blockHash)\n    if (currentHeight) {\n      normalizedTx.confirmations = currentHeight - normalizedTx.blockNumber + 1\n    }\n  }\n\n  if (tx.gas && tx.gasPrice) {\n    const gas = new BigNumber(tx.gas)\n    const gasPrice = new BigNumber(tx.gasPrice)\n\n    normalizedTx.fee = gas.times(gasPrice).toNumber()\n    normalizedTx.feePrice = gasPrice.div(GWEI).toNumber()\n  }\n\n  return normalizedTx\n}\n\nfunction buildTransaction(txOptions: ethereum.UnsignedTransaction): ethereum.TransactionRequest {\n  if (!txOptions.to && (typeof txOptions.data !== 'string' || txOptions.data.length === 0)) {\n    throw new Error('Sending to null with no data. Aborting.')\n  }\n\n  const tx: ethereum.TransactionRequest = {\n    from: ensure0x(txOptions.from),\n    value: txOptions.value ? numberToHex(txOptions.value) : '0x0'\n  }\n\n  if (txOptions.gasPrice)\n    tx.gasPrice = ensure0x(txOptions.gasPrice.times(GWEI).dp(0, BigNumber.ROUND_CEIL).toString(16))\n  if (txOptions.to) tx.to = ensure0x(txOptions.to)\n  if (txOptions.data) tx.data = ensure0x(txOptions.data)\n  if (txOptions.nonce !== null && txOptions.nonce !== undefined) tx.nonce = ensure0x(txOptions.nonce.toString(16))\n\n  return tx\n}\n\nfunction validateAddress(_address: Address | string) {\n  const address = remove0x(addressToString(_address))\n\n  if (typeof address !== 'string') {\n    throw new InvalidAddressError(`Invalid address: ${address}`)\n  }\n\n  if (Buffer.from(address, 'hex').toString('hex') !== address.toLowerCase()) {\n    throw new InvalidAddressError(`Invalid address. Not hex: ${address}`)\n  }\n\n  if (Buffer.byteLength(address, 'hex') !== 20) {\n    throw new InvalidAddressError(`Invalid address: ${address}`)\n  }\n}\n\nfunction validateExpiration(expiration: number) {\n  _validateExpiration(expiration)\n\n  const expirationHex = expiration.toString(16)\n  const expirationSize = 5\n  const expirationEncoded = padHexStart(expirationHex, expirationSize) // Pad with 0. string length\n\n  if (Buffer.byteLength(expirationEncoded, 'hex') > expirationSize) {\n    throw new InvalidExpirationError(`Invalid expiration: ${expiration}`)\n  }\n}\n\nexport {\n  ensure0x,\n  remove0x,\n  hexToNumber,\n  numberToHex,\n  checksumEncode,\n  normalizeTransactionObject,\n  ensureBlockFormat,\n  buildTransaction,\n  validateAddress,\n  validateExpiration\n}\n","module.exports = require(\"@liquality/crypto\");","module.exports = require(\"@liquality/errors\");","module.exports = require(\"@liquality/types\");","module.exports = require(\"@liquality/utils\");","module.exports = require(\"eip55\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(175);\n"],"names":["GWEI","ensure0x","hash","startsWith","remove0x","slice","hexToNumber","hex","parseInt","numberToHex","number","BigNumber","toString","checksumEncode","encode","ensureBlockFormat","block","undefined","padHexStart","normalizeTransactionObject","tx","currentHeight","Error","normalizedTx","value","_raw","blockNumber","blockHash","confirmations","gas","gasPrice","fee","times","toNumber","feePrice","div","buildTransaction","txOptions","to","data","length","from","dp","ROUND_CEIL","nonce","validateAddress","_address","address","addressToString","InvalidAddressError","Buffer","toLowerCase","byteLength","validateExpiration","expiration","expirationHex","expirationEncoded","InvalidExpirationError","module","exports","require","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"sourceRoot":""}